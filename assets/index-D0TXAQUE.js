import"./OrbitControls-DI2741t5.js";import{R as vt,V as l,l as At,Q as Z,O as pt,M as mt,L as Et,m as M,B as _,n as dt,F as ft,a as s,o as nt,p as H,f as Yt,T as G,d as It,h as Qt,E as Zt,q as zt,c as Tt,r as Ht,s as Lt,t as Dt,u as kt,v as jt,k as lt,w as Rt}from"./three.core-BWGKd-O1.js";import{G as qt,B as Ct}from"./base-three-DlDRCK0E.js";import{_ as Ot}from"./plugin-vueexport-helper-DlAUqK2U.js";import{f as Ft,g as Gt,e as Wt,d as Bt,o as Nt}from"./index-BWXbnMxx.js";const k=new vt,g=new l,L=new l,d=new Z,wt={X:new l(1,0,0),Y:new l(0,1,0),Z:new l(0,0,1)},ct={type:"change"},yt={type:"mouseDown",mode:null},xt={type:"mouseUp",mode:null},_t={type:"objectChange"};class Ut extends At{constructor(o,e=null){super(void 0,e);const n=new ee(this);this._root=n;const i=new ne;this._gizmo=i,n.add(i);const h=new ie;this._plane=h,n.add(h);const t=this;function a(c,S){let z=S;Object.defineProperty(t,c,{get:function(){return z!==void 0?z:S},set:function(X){z!==X&&(z=X,h[c]=X,i[c]=X,t.dispatchEvent({type:c+"-changed",value:X}),t.dispatchEvent(ct))}}),t[c]=S,h[c]=S,i[c]=S}a("camera",o),a("object",void 0),a("enabled",!0),a("axis",null),a("mode","translate"),a("translationSnap",null),a("rotationSnap",null),a("scaleSnap",null),a("space","world"),a("size",1),a("dragging",!1),a("showX",!0),a("showY",!0),a("showZ",!0),a("minX",-1/0),a("maxX",1/0),a("minY",-1/0),a("maxY",1/0),a("minZ",-1/0),a("maxZ",1/0);const P=new l,u=new l,Y=new Z,E=new Z,D=new l,V=new Z,R=new l,b=new l,A=new l,I=0,r=new l;a("worldPosition",P),a("worldPositionStart",u),a("worldQuaternion",Y),a("worldQuaternionStart",E),a("cameraPosition",D),a("cameraQuaternion",V),a("pointStart",R),a("pointEnd",b),a("rotationAxis",A),a("rotationAngle",I),a("eye",r),this._offset=new l,this._startNorm=new l,this._endNorm=new l,this._cameraScale=new l,this._parentPosition=new l,this._parentQuaternion=new Z,this._parentQuaternionInv=new Z,this._parentScale=new l,this._worldScaleStart=new l,this._worldQuaternionInv=new Z,this._worldScale=new l,this._positionStart=new l,this._quaternionStart=new Z,this._scaleStart=new l,this._getPointer=Vt.bind(this),this._onPointerDown=Kt.bind(this),this._onPointerHover=Jt.bind(this),this._onPointerMove=$t.bind(this),this._onPointerUp=te.bind(this),e!==null&&this.connect()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="auto"}getHelper(){return this._root}pointerHover(o){if(this.object===void 0||this.dragging===!0)return;o!==null&&k.setFromCamera(o,this.camera);const e=ht(this._gizmo.picker[this.mode],k);e?this.axis=e.object.name:this.axis=null}pointerDown(o){if(!(this.object===void 0||this.dragging===!0||o!=null&&o.button!==0)&&this.axis!==null){o!==null&&k.setFromCamera(o,this.camera);const e=ht(this._plane,k,!0);e&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(e.point).sub(this.worldPositionStart)),this.dragging=!0,yt.mode=this.mode,this.dispatchEvent(yt)}}pointerMove(o){const e=this.axis,n=this.mode,i=this.object;let h=this.space;if(n==="scale"?h="local":(e==="E"||e==="XYZE"||e==="XYZ")&&(h="world"),i===void 0||e===null||this.dragging===!1||o!==null&&o.button!==-1)return;o!==null&&k.setFromCamera(o,this.camera);const t=ht(this._plane,k,!0);if(t){if(this.pointEnd.copy(t.point).sub(this.worldPositionStart),n==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),h==="local"&&e!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),e.indexOf("X")===-1&&(this._offset.x=0),e.indexOf("Y")===-1&&(this._offset.y=0),e.indexOf("Z")===-1&&(this._offset.z=0),h==="local"&&e!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),i.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(h==="local"&&(i.position.applyQuaternion(d.copy(this._quaternionStart).invert()),e.search("X")!==-1&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),e.search("Y")!==-1&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),e.search("Z")!==-1&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.position.applyQuaternion(this._quaternionStart)),h==="world"&&(i.parent&&i.position.add(g.setFromMatrixPosition(i.parent.matrixWorld)),e.search("X")!==-1&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),e.search("Y")!==-1&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),e.search("Z")!==-1&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.parent&&i.position.sub(g.setFromMatrixPosition(i.parent.matrixWorld)))),i.position.x=Math.max(this.minX,Math.min(this.maxX,i.position.x)),i.position.y=Math.max(this.minY,Math.min(this.maxY,i.position.y)),i.position.z=Math.max(this.minZ,Math.min(this.maxZ,i.position.z));else if(n==="scale"){if(e.search("XYZ")!==-1){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),L.set(a,a,a)}else g.copy(this.pointStart),L.copy(this.pointEnd),g.applyQuaternion(this._worldQuaternionInv),L.applyQuaternion(this._worldQuaternionInv),L.divide(g),e.search("X")===-1&&(L.x=1),e.search("Y")===-1&&(L.y=1),e.search("Z")===-1&&(L.z=1);i.scale.copy(this._scaleStart).multiply(L),this.scaleSnap&&(e.search("X")!==-1&&(i.scale.x=Math.round(i.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),e.search("Y")!==-1&&(i.scale.y=Math.round(i.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),e.search("Z")!==-1&&(i.scale.z=Math.round(i.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(n==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(g.setFromMatrixPosition(this.camera.matrixWorld));let P=!1;e==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(g.copy(this.rotationAxis).cross(this.eye))*a):(e==="X"||e==="Y"||e==="Z")&&(this.rotationAxis.copy(wt[e]),g.copy(wt[e]),h==="local"&&g.applyQuaternion(this.worldQuaternion),g.cross(this.eye),g.length()===0?P=!0:this.rotationAngle=this._offset.dot(g.normalize())*a),(e==="E"||P)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),h==="local"&&e!=="E"&&e!=="XYZE"?(i.quaternion.copy(this._quaternionStart),i.quaternion.multiply(d.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),i.quaternion.copy(d.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),i.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(ct),this.dispatchEvent(_t)}}pointerUp(o){o!==null&&o.button!==0||(this.dragging&&this.axis!==null&&(xt.mode=this.mode,this.dispatchEvent(xt)),this.dragging=!1,this.axis=null)}dispose(){this.disconnect(),this._root.dispose()}attach(o){return this.object=o,this._root.visible=!0,this}detach(){return this.object=void 0,this.axis=null,this._root.visible=!1,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(ct),this.dispatchEvent(_t),this.pointStart.copy(this.pointEnd))}getRaycaster(){return k}getMode(){return this.mode}setMode(o){this.mode=o}setTranslationSnap(o){this.translationSnap=o}setRotationSnap(o){this.rotationSnap=o}setScaleSnap(o){this.scaleSnap=o}setSize(o){this.size=o}setSpace(o){this.space=o}}function Vt(m){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:m.button};{const o=this.domElement.getBoundingClientRect();return{x:(m.clientX-o.left)/o.width*2-1,y:-(m.clientY-o.top)/o.height*2+1,button:m.button}}}function Jt(m){if(this.enabled)switch(m.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(m));break}}function Kt(m){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(m.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(m)),this.pointerDown(this._getPointer(m)))}function $t(m){this.enabled&&this.pointerMove(this._getPointer(m))}function te(m){this.enabled&&(this.domElement.releasePointerCapture(m.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(m)))}function ht(m,o,e){const n=o.intersectObject(m,!0);for(let i=0;i<n.length;i++)if(n[i].object.visible||e)return n[i];return!1}const it=new Zt,p=new l(0,1,0),gt=new l(0,0,0),bt=new zt,ot=new Z,at=new Z,Q=new l,Pt=new zt,N=new l(1,0,0),j=new l(0,1,0),U=new l(0,0,1),st=new l,W=new l,B=new l;class ee extends pt{constructor(o){super(),this.isTransformControlsRoot=!0,this.controls=o,this.visible=!1}updateMatrixWorld(o){const e=this.controls;e.object!==void 0&&(e.object.updateMatrixWorld(),e.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):e.object.parent.matrixWorld.decompose(e._parentPosition,e._parentQuaternion,e._parentScale),e.object.matrixWorld.decompose(e.worldPosition,e.worldQuaternion,e._worldScale),e._parentQuaternionInv.copy(e._parentQuaternion).invert(),e._worldQuaternionInv.copy(e.worldQuaternion).invert()),e.camera.updateMatrixWorld(),e.camera.matrixWorld.decompose(e.cameraPosition,e.cameraQuaternion,e._cameraScale),e.camera.isOrthographicCamera?e.camera.getWorldDirection(e.eye).negate():e.eye.copy(e.cameraPosition).sub(e.worldPosition).normalize(),super.updateMatrixWorld(o)}dispose(){this.traverse(function(o){o.geometry&&o.geometry.dispose(),o.material&&o.material.dispose()})}}class ne extends pt{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const o=new mt({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),e=new Et({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=o.clone();n.opacity=.15;const i=e.clone();i.opacity=.5;const h=o.clone();h.color.setHex(16711680);const t=o.clone();t.color.setHex(65280);const a=o.clone();a.color.setHex(255);const P=o.clone();P.color.setHex(16711680),P.opacity=.5;const u=o.clone();u.color.setHex(65280),u.opacity=.5;const Y=o.clone();Y.color.setHex(255),Y.opacity=.5;const E=o.clone();E.opacity=.25;const D=o.clone();D.color.setHex(16776960),D.opacity=.25,o.clone().color.setHex(16776960);const R=o.clone();R.color.setHex(7895160);const b=new M(0,.04,.1,12);b.translate(0,.05,0);const A=new _(.08,.08,.08);A.translate(0,.04,0);const I=new dt;I.setAttribute("position",new ft([0,0,0,1,0,0],3));const r=new M(.0075,.0075,.5,3);r.translate(0,.25,0);function c(w,q){const v=new G(w,.0075,3,64,q*Math.PI*2);return v.rotateY(Math.PI/2),v.rotateX(Math.PI/2),v}function S(){const w=new dt;return w.setAttribute("position",new ft([0,0,0,1,1,1],3)),w}const z={X:[[new s(b,h),[.5,0,0],[0,0,-Math.PI/2]],[new s(b,h),[-.5,0,0],[0,0,Math.PI/2]],[new s(r,h),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new s(b,t),[0,.5,0]],[new s(b,t),[0,-.5,0],[Math.PI,0,0]],[new s(r,t)]],Z:[[new s(b,a),[0,0,.5],[Math.PI/2,0,0]],[new s(b,a),[0,0,-.5],[-Math.PI/2,0,0]],[new s(r,a),null,[Math.PI/2,0,0]]],XYZ:[[new s(new nt(.1,0),E.clone()),[0,0,0]]],XY:[[new s(new _(.15,.15,.01),Y.clone()),[.15,.15,0]]],YZ:[[new s(new _(.15,.15,.01),P.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new s(new _(.15,.15,.01),u.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},X={X:[[new s(new M(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new s(new M(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new s(new M(.2,0,.6,4),n),[0,.3,0]],[new s(new M(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new s(new M(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new s(new M(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new s(new nt(.2,0),n)]],XY:[[new s(new _(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new s(new _(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new s(new _(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},rt={START:[[new s(new nt(.01,2),i),null,null,null,"helper"]],END:[[new s(new nt(.01,2),i),null,null,null,"helper"]],DELTA:[[new H(S(),i),null,null,null,"helper"]],X:[[new H(I,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new H(I,i.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new H(I,i.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},J={XYZE:[[new s(c(.5,1),R),null,[0,Math.PI/2,0]]],X:[[new s(c(.5,.5),h)]],Y:[[new s(c(.5,.5),t),null,[0,0,-Math.PI/2]]],Z:[[new s(c(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new s(c(.75,1),D),null,[0,Math.PI/2,0]]]},C={AXIS:[[new H(I,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},O={XYZE:[[new s(new Yt(.25,10,8),n)]],X:[[new s(new G(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new s(new G(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new s(new G(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new s(new G(.75,.1,2,24),n)]]},K={X:[[new s(A,h),[.5,0,0],[0,0,-Math.PI/2]],[new s(r,h),[0,0,0],[0,0,-Math.PI/2]],[new s(A,h),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new s(A,t),[0,.5,0]],[new s(r,t)],[new s(A,t),[0,-.5,0],[0,0,Math.PI]]],Z:[[new s(A,a),[0,0,.5],[Math.PI/2,0,0]],[new s(r,a),[0,0,0],[Math.PI/2,0,0]],[new s(A,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new s(new _(.15,.15,.01),Y),[.15,.15,0]]],YZ:[[new s(new _(.15,.15,.01),P),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new s(new _(.15,.15,.01),u),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new s(new _(.1,.1,.1),E.clone())]]},F={X:[[new s(new M(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new s(new M(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new s(new M(.2,0,.6,4),n),[0,.3,0]],[new s(new M(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new s(new M(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new s(new M(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new s(new _(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new s(new _(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new s(new _(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new s(new _(.2,.2,.2),n),[0,0,0]]]},y={X:[[new H(I,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new H(I,i.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new H(I,i.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function f(w){const q=new pt;for(const v in w)for(let T=w[v].length;T--;){const x=w[v][T][0].clone(),$=w[v][T][1],tt=w[v][T][2],et=w[v][T][3],Xt=w[v][T][4];x.name=v,x.tag=Xt,$&&x.position.set($[0],$[1],$[2]),tt&&x.rotation.set(tt[0],tt[1],tt[2]),et&&x.scale.set(et[0],et[1],et[2]),x.updateMatrix();const ut=x.geometry.clone();ut.applyMatrix4(x.matrix),x.geometry=ut,x.renderOrder=1/0,x.position.set(0,0,0),x.rotation.set(0,0,0),x.scale.set(1,1,1),q.add(x)}return q}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=f(z)),this.add(this.gizmo.rotate=f(J)),this.add(this.gizmo.scale=f(K)),this.add(this.picker.translate=f(X)),this.add(this.picker.rotate=f(O)),this.add(this.picker.scale=f(F)),this.add(this.helper.translate=f(rt)),this.add(this.helper.rotate=f(C)),this.add(this.helper.scale=f(y)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(o){const n=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:at;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let i=[];i=i.concat(this.picker[this.mode].children),i=i.concat(this.gizmo[this.mode].children),i=i.concat(this.helper[this.mode].children);for(let h=0;h<i.length;h++){const t=i[h];t.visible=!0,t.rotation.set(0,0,0),t.position.copy(this.worldPosition);let a;if(this.camera.isOrthographicCamera?a=(this.camera.top-this.camera.bottom)/this.camera.zoom:a=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),t.scale.set(1,1,1).multiplyScalar(a*this.size/4),t.tag==="helper"){t.visible=!1,t.name==="AXIS"?(t.visible=!!this.axis,this.axis==="X"&&(d.setFromEuler(it.set(0,0,0)),t.quaternion.copy(n).multiply(d),Math.abs(p.copy(N).applyQuaternion(n).dot(this.eye))>.9&&(t.visible=!1)),this.axis==="Y"&&(d.setFromEuler(it.set(0,0,Math.PI/2)),t.quaternion.copy(n).multiply(d),Math.abs(p.copy(j).applyQuaternion(n).dot(this.eye))>.9&&(t.visible=!1)),this.axis==="Z"&&(d.setFromEuler(it.set(0,Math.PI/2,0)),t.quaternion.copy(n).multiply(d),Math.abs(p.copy(U).applyQuaternion(n).dot(this.eye))>.9&&(t.visible=!1)),this.axis==="XYZE"&&(d.setFromEuler(it.set(0,Math.PI/2,0)),p.copy(this.rotationAxis),t.quaternion.setFromRotationMatrix(bt.lookAt(gt,p,j)),t.quaternion.multiply(d),t.visible=this.dragging),this.axis==="E"&&(t.visible=!1)):t.name==="START"?(t.position.copy(this.worldPositionStart),t.visible=this.dragging):t.name==="END"?(t.position.copy(this.worldPosition),t.visible=this.dragging):t.name==="DELTA"?(t.position.copy(this.worldPositionStart),t.quaternion.copy(this.worldQuaternionStart),g.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),g.applyQuaternion(this.worldQuaternionStart.clone().invert()),t.scale.copy(g),t.visible=this.dragging):(t.quaternion.copy(n),this.dragging?t.position.copy(this.worldPositionStart):t.position.copy(this.worldPosition),this.axis&&(t.visible=this.axis.search(t.name)!==-1));continue}t.quaternion.copy(n),this.mode==="translate"||this.mode==="scale"?(t.name==="X"&&Math.abs(p.copy(N).applyQuaternion(n).dot(this.eye))>.99&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="Y"&&Math.abs(p.copy(j).applyQuaternion(n).dot(this.eye))>.99&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="Z"&&Math.abs(p.copy(U).applyQuaternion(n).dot(this.eye))>.99&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="XY"&&Math.abs(p.copy(U).applyQuaternion(n).dot(this.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="YZ"&&Math.abs(p.copy(N).applyQuaternion(n).dot(this.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1),t.name==="XZ"&&Math.abs(p.copy(j).applyQuaternion(n).dot(this.eye))<.2&&(t.scale.set(1e-10,1e-10,1e-10),t.visible=!1)):this.mode==="rotate"&&(ot.copy(n),p.copy(this.eye).applyQuaternion(d.copy(n).invert()),t.name.search("E")!==-1&&t.quaternion.setFromRotationMatrix(bt.lookAt(this.eye,gt,j)),t.name==="X"&&(d.setFromAxisAngle(N,Math.atan2(-p.y,p.z)),d.multiplyQuaternions(ot,d),t.quaternion.copy(d)),t.name==="Y"&&(d.setFromAxisAngle(j,Math.atan2(p.x,p.z)),d.multiplyQuaternions(ot,d),t.quaternion.copy(d)),t.name==="Z"&&(d.setFromAxisAngle(U,Math.atan2(p.y,p.x)),d.multiplyQuaternions(ot,d),t.quaternion.copy(d))),t.visible=t.visible&&(t.name.indexOf("X")===-1||this.showX),t.visible=t.visible&&(t.name.indexOf("Y")===-1||this.showY),t.visible=t.visible&&(t.name.indexOf("Z")===-1||this.showZ),t.visible=t.visible&&(t.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),t.material._color=t.material._color||t.material.color.clone(),t.material._opacity=t.material._opacity||t.material.opacity,t.material.color.copy(t.material._color),t.material.opacity=t.material._opacity,this.enabled&&this.axis&&(t.name===this.axis||this.axis.split("").some(function(P){return t.name===P}))&&(t.material.color.setHex(16776960),t.material.opacity=1)}super.updateMatrixWorld(o)}}class ie extends s{constructor(){super(new It(1e5,1e5,2,2),new mt({visible:!1,wireframe:!0,side:Qt,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(o){let e=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(e="local"),st.copy(N).applyQuaternion(e==="local"?this.worldQuaternion:at),W.copy(j).applyQuaternion(e==="local"?this.worldQuaternion:at),B.copy(U).applyQuaternion(e==="local"?this.worldQuaternion:at),p.copy(W),this.mode){case"translate":case"scale":switch(this.axis){case"X":p.copy(this.eye).cross(st),Q.copy(st).cross(p);break;case"Y":p.copy(this.eye).cross(W),Q.copy(W).cross(p);break;case"Z":p.copy(this.eye).cross(B),Q.copy(B).cross(p);break;case"XY":Q.copy(B);break;case"YZ":Q.copy(st);break;case"XZ":p.copy(B),Q.copy(W);break;case"XYZ":case"E":Q.set(0,0,0);break}break;case"rotate":default:Q.set(0,0,0)}Q.length()===0?this.quaternion.copy(this.cameraQuaternion):(Pt.lookAt(g.set(0,0,0),Q,p),this.quaternion.setFromRotationMatrix(Pt)),super.updateMatrixWorld(o)}}const oe={class:"rollercoaster"},Mt=200,St=15*1e3,se={__name:"index",setup(m){const o=new qt,e=Ft(null);let n,i;const h=[{x:0,y:10,z:-10},{x:10,y:0,z:-10},{x:20,y:0,z:0},{x:30,y:0,z:10},{x:30,y:0,z:20},{x:20,y:0,z:30},{x:10,y:0,z:30},{x:0,y:0,z:30},{x:-10,y:10,z:30},{x:-10,y:20,z:30},{x:0,y:30,z:30},{x:10,y:30,z:30},{x:20,y:30,z:15},{x:10,y:30,z:10},{x:0,y:30,z:10},{x:-10,y:20,z:10},{x:-10,y:10,z:10},{x:0,y:0,z:10},{x:10,y:-10,z:10},{x:20,y:-15,z:10},{x:30,y:-15,z:10},{x:40,y:-15,z:10},{x:50,y:-15,z:10},{x:50,y:0,z:10},{x:40,y:0,z:0},{x:30,y:0,z:0},{x:20,y:0,z:0},{x:10,y:0,z:0}].map(r=>(r.x=r.x-20,r.z=r.z-10,r)),t=new _(.1,.1,.1),a=new mt(16777215),P=r=>{const c=new s(t,a);return c.position.copy(r),n.scene.add(c),c};let u=null,Y,E;function D(r){const c=E.getPointAt(r);u==null||u.position.copy(c)}function V(r){const c=E.getTangentAt(r),S=E.getPointAt(r),z=c.add(S);u==null||u.lookAt(z)}const R=new Rt;let b=null;const A=()=>{let r=R.getDelta();b==null||b.update(r)},I=()=>{let c=Date.now()%St/St;V(c),D(c),A()};return Gt(()=>{if(e.value){n=new Ct(e.value),n.camera.position.set(40,70,100),n.camera.lookAt(0,0,0),n.animate(),n.renderAnimateFunc=I,n.renderer.shadowMap.enabled=!0,i=new Ut(n.camera,n.renderer.domElement),i.addEventListener("dragging-changed",function(y){if(n.controls.enabled=!y.value,!y.value){const f=E.getPoints(Mt);J.geometry.setFromPoints(f)}}),n.scene.add(i.getHelper()),Y=h.map(y=>P(y));const r=new Tt(16777215,6);r.position.set(-20,60,0),r.decay=0,r.castShadow=!0,n.scene.add(r);const c=new It(150,150);c.rotateX(-Math.PI/2);const S=new Ht({color:16777215,opacity:.2}),z=new s(c,S);z.position.y=-20,z.receiveShadow=!0,n.scene.add(z);const X=new Lt(150,150);X.position.y=-20,X.material.opacity=.5,X.material.transparent=!0,n.scene.add(X),E=new Dt(Y.map(y=>y.position),!0,"chordal");const rt=E.getPoints(Mt),J=new kt(new dt().setFromPoints(rt),new Et({color:5675203}));n.scene.add(J);const C=new lt;n.renderer.domElement.addEventListener("pointerdown",y=>{const{offsetX:f,offsetY:w}=y;C.x=f,C.y=w},!1);const O=new lt;n.renderer.domElement.addEventListener("pointerup",y=>{const{offsetX:f,offsetY:w}=y;O.x=f,O.y=w,C.distanceTo(O)===0&&i.detach()},!1);const K=new vt,F=new lt;n.renderer.domElement.addEventListener("pointermove",y=>{const{offsetX:f,offsetY:w}=y,{clientWidth:q,clientHeight:v}=n.renderer.domElement;F.x=f/q*2-1,F.y=-(w/v)*2+1,K.setFromCamera(F,n.camera);const T=K.intersectObjects(Y,!1);if(T.length){const x=T[0].object;x!==i.object&&i.attach(x)}},!1),o.load("/models/Parrot.glb",function(y){u=y.scene.children[0];const f=.05;u.scale.set(f,f,f),u.position.y=0,u.rotation.y=-1,u.castShadow=!0,u.receiveShadow=!0,n.scene.add(u),b=new jt(u),b.clipAction(y.animations[0]).setDuration(.5).play()})}}),(r,c)=>(Nt(),Wt("div",oe,[Bt("div",{id:"container",ref_key:"containerRef",ref:e,onMousemove:c[0]||(c[0]=(...S)=>r.mouseMove&&r.mouseMove(...S))},null,544)]))}},pe=Ot(se,[["__scopeId","data-v-ddce9568"]]);export{pe as default};
